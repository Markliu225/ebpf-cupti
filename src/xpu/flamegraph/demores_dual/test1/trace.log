Using device: cuda | params=3,148,801
Epoch 01/10 | loss=2060.85249 | time=0.937s | mem=97.3 MiB
Epoch 02/10 | loss=2050.74563 | time=0.713s | mem=97.3 MiB
Epoch 03/10 | loss=2041.46902 | time=0.713s | mem=97.3 MiB
Epoch 04/10 | loss=2040.75649 | time=0.712s | mem=97.3 MiB
Epoch 05/10 | loss=2054.71631 | time=0.712s | mem=97.3 MiB
Epoch 06/10 | loss=2062.30941 | time=0.712s | mem=97.3 MiB
Epoch 07/10 | loss=2047.44956 | time=0.711s | mem=97.3 MiB
Epoch 08/10 | loss=2049.29214 | time=0.712s | mem=97.3 MiB
Epoch 09/10 | loss=2051.98128 | time=0.713s | mem=97.3 MiB
Epoch 10/10 | loss=2037.86447 | time=0.714s | mem=97.3 MiB
训练结束，可搭配 cuda_cupti_integrator.py 同时运行以采集事件。
CUPTI trace output will be written to: /home/mark/workspace/ebpf-cupti/src/xpu/flamegraph/demores_dual/test1/gpu_results.txt
Calling CUPTI API: cuptiSubscribe(&globals.subscriberHandle, (CUpti_CallbackFunc)pTraceCallback, pUserData)
Calling CUPTI API: cuptiEnableCallback(1, globals.subscriberHandle, CUPTI_CB_DOMAIN_RUNTIME_API, CUPTI_RUNTIME_TRACE_CBID_cudaDeviceReset_v3020)
Calling CUPTI API: cuptiEnableCallback(1, globals.subscriberHandle, CUPTI_CB_DOMAIN_STATE, CUPTI_CBID_STATE_FATAL_ERROR)
Calling CUPTI API: cuptiActivityRegisterCallbacks(BufferRequested, BufferCompleted)
Activity buffer size = 33554432 bytes.
Calling CUPTI API: cuptiEnableCallback(1, injectionGlobals.subscriberHandle, CUPTI_CB_DOMAIN_DRIVER_API, CUPTI_DRIVER_TRACE_CBID_cuProfilerStart)
Calling CUPTI API: cuptiEnableCallback(1, injectionGlobals.subscriberHandle, CUPTI_CB_DOMAIN_DRIVER_API, CUPTI_DRIVER_TRACE_CBID_cuProfilerStop)
Calling CUPTI API: cuptiEnableCallback(1, injectionGlobals.subscriberHandle, CUPTI_CB_DOMAIN_RESOURCE, CUPTI_CBID_RESOURCE_GRAPHNODE_CREATED)
Calling CUPTI API: cuptiEnableCallback(1, injectionGlobals.subscriberHandle, CUPTI_CB_DOMAIN_RESOURCE, CUPTI_CBID_RESOURCE_GRAPHNODE_CLONED)
Calling CUPTI API: cuptiEnableDomain(1, injectionGlobals.subscriberHandle, CUPTI_CB_DOMAIN_RUNTIME_API)
Calling CUPTI API: cuptiEnableCallback(1, injectionGlobals.subscriberHandle, CUPTI_CB_DOMAIN_RUNTIME_API, CUPTI_RUNTIME_TRACE_CBID_cudaDeviceReset_v3020)
Enabling CUPTI_ACTIVITY_KIND_RUNTIME.
Enabling CUPTI_ACTIVITY_KIND_CONCURRENT_KERNEL.
Calling CUPTI API: cuptiEnableCallback(0, injectionGlobals.subscriberHandle, CUPTI_CB_DOMAIN_RUNTIME_API, CUPTI_RUNTIME_TRACE_CBID_cudaDeviceReset_v3020)
Disabling CUPTI_ACTIVITY_KIND_RUNTIME.
Disabling CUPTI_ACTIVITY_KIND_CONCURRENT_KERNEL.
Calling CUPTI API: cuptiActivityFlushAll(1)
[CPU] 启动 eBPF profiler，输出: /home/mark/workspace/ebpf-cupti/src/xpu/flamegraph/demores_dual/test1/cpu_results.txt
执行命令: cd /home/mark/workspace/ebpf-cupti/src/xpu/flamegraph && /home/mark/anaconda3/envs/ebpf-cupti/bin/python gpu_profiler/test1.py
[CPU] 停止 eBPF profiler
[GPU] Chrome Trace 写入 /home/mark/workspace/ebpf-cupti/src/xpu/flamegraph/demores_dual/test1/gpu_results.json
Parsing CPU uprobe trace (extended folded format): /home/mark/workspace/ebpf-cupti/src/xpu/flamegraph/demores_dual/test1/cpu_results.txt
Warning: Failed to parse line: 2025-12-09T15:35:46.461620Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461620Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461641Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461641Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461650Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461650Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461660Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461660Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461670Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461670Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461679Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461679Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461689Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461689Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461698Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461698Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461707Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461707Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461716Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461716Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461727Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461727Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461739Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461739Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461748Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461748Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461757Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461757Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461766Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461766Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461775Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461775Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461784Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461784Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461793Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461793Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461802Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461802Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461811Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461811Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461819Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461819Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461828Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461828Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461836Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461836Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461845Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461845Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.461854Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.461854Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494365Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494365Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494378Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494378Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494388Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494388Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494397Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494397Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494407Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494407Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494417Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494417Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494426Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494426Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494438Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494438Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494447Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494447Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494457Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494457Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494468Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494468Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494477Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494477Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494486Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494486Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494495Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494495Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494504Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494504Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494513Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494513Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494522Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494522Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494531Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494531Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494540Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494540Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494549Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494549Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494557Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494557Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494566Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494566Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494576Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494576Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494585Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494585Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.494593Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.494593Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527197Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527197Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527211Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527211Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527220Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527220Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527231Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527231Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527250Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527250Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527260Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527260Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527269Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527269Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527278Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527278Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527288Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527288Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527297Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527297Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527307Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527307Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527317Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527317Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527326Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527326Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527335Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527335Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527344Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527344Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527353Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527353Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527362Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527362Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527373Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527373Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527382Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527382Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527391Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527391Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527399Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527399Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527408Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527408Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527416Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527416Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527424Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527424Z'
Warning: Failed to parse line: 2025-12-09T15:35:46.527433Z ERROR blazesym::symbolize::symbolizer: error=proc maps does not contain ... Error: invalid literal for int() with base 10: '2025-12-09T15:35:46.527433Z'
Parsed 12036 CPU stack traces from cudaLaunchKernel hooks
Found 2 unique threads
Parsing GPU CUPTI trace: /home/mark/workspace/ebpf-cupti/src/xpu/flamegraph/demores_dual/test1/gpu_results.json
Parsed 17012 GPU kernel events
Parsed 15512 cudaLaunchKernel runtime events
Correlating CPU stacks with GPU kernels...
  Thread (245348, 245348): Using sequential+time matching (CPU=4037, GPU=15512)
    Estimated clock offset: 113.81 ms
    Skipped: 0 CPU events, 960 GPU events (outside time window)
Matched 4037 CPU stacks with GPU kernels
Unmatched: 7999 CPU stacks (may indicate missing GPU events)
Total unique stacks: 711
Writing folded output to: /home/mark/workspace/ebpf-cupti/src/xpu/flamegraph/demores_dual/test1/cpu_gpu_merged.folded
Wrote 711 unique stacks (929322 total samples)
[MERGE] 合并结果写入 /home/mark/workspace/ebpf-cupti/src/xpu/flamegraph/demores_dual/test1/cpu_gpu_merged.folded
Timeline written to: /home/mark/workspace/ebpf-cupti/src/xpu/flamegraph/demores_dual/test1/cpu_gpu_timeline.txt
完成: 原始 GPU trace、CPU 报文以及可选 merged 结果均已生成。
